/**
 * multiscroll.js 0.1.7 Beta (Customized with auto-height section)
 * https://github.com/alvarotrigo/multiscroll.js
 *
 * Copyright (C) 2013 alvarotrigo.com - A project by Alvaro Trigo
 */
(function(a,h,f,v,E){a.fn.multiscroll=function(c){function w(){var b=h.location.hash.replace("#","");if(b.length){var d=a(".ms-left").find('[data-anchor="'+b+'"]');if(d.length){var l="undefined"===typeof lastScrolledDestiny;if(l||b!==lastScrolledDestiny)a(".ms-auto-height").hasClass("active")?q("up",function(){console.warn("callback!");g(d)}):g(d)}else b==c.anchors[c.anchors.length-1]&&(b=c.anchors[c.anchors.length-2],d=a(".ms-left").find('[data-anchor="'+b+'"]'),(l="undefined"===typeof lastScrolledDestiny)||
c.anchors[c.anchors.length-1]!==lastScrolledDestiny)&&(console.log("2wewww"),console.log(d),g(d),setTimeout(function(){e.moveSectionDown()},c.scrollingSpeed))}}function x(){y=a(h).height();a(".ms-tableCell").each(function(){a(this).css({height:F(a(this).parent())})});G();a.isFunction(c.afterResize)&&c.afterResize.call(this)}function G(){c.css3?(r(a(".ms-left"),"translate3d(0px, -"+a(".ms-left").find(".ms-section.active").position().top+"px, 0px)",!1),r(a(".ms-right"),"translate3d(0px, -"+a(".ms-right").find(".ms-section.active").position().top+
"px, 0px)",!1)):(a(".ms-left").css("top",-a(".ms-left").find(".ms-section.active").position().top),a(".ms-right").css("top",-a(".ms-right").find(".ms-section.active").position().top))}function z(b){13==a("a").length&&(console.log(m),q(b))}function q(b,d){var l=a(".ms-auto-height"),e=a(".ms-left .ms-section").length,f=a(".ms-auto-height").data("anchor"),g=e-1;l.position();a(h).height();l.height();a.isFunction(c.onLeave)&&c.onLeave.call(this,g,e+1,b);if("down"==b)g=l.height(),l.addClass("active"),a(".ms-left").find(".ms-section").removeClass("active"),
a(".ms-right").find(".ms-section").removeClass("active"),A(f),lastScrolledDestiny=f,B(f),C(f,e);else{g="0";l.removeClass("active");a(".ms-left").find(".ms-section").last().addClass("active");a(".ms-right").find(".ms-section").first().addClass("active");var k=a(".ms-left").find(".ms-section").last();A(k.data("anchor"));B(k.data("anchor"));C(k.data("anchor"),k.index())}m=!0;c.css3&&l.addClass("ms-easing");l.animate({marginTop:-g},c.scrollingSpeed,c.easing,function(){"down"==b&&a.isFunction(c.afterLoad)&&
c.afterLoad.call(this,f,e+1);a.isFunction(d)&&d.call(this)});H(g,b)}function H(b,d){if(c.css3)a(".ms-right").animate({top:-b},c.scrollingSpeed,c.easing),a(".ms-left").animate({top:-b},c.scrollingSpeed,c.easing,function(){setTimeout(function(){m=!1},600)});else{var e=a(".ms-left").find(".ms-section").last().position().top;a(".ms-right").animate({top:-b},c.scrollingSpeed,c.easing);e=-e-b;"up"==d&&(e=parseInt(a(".ms-left").css("top"))+a(".ms-auto-height").height());a(".ms-left").animate({top:e},c.scrollingSpeed,
c.easing,function(){setTimeout(function(){m=!1},600)})}}function g(b){if(13==a("a").length){var d=b.index(),e=a(".ms-right").find(".ms-section").eq(O-1-d),f=b.data("anchor"),g=a(".ms-left .ms-section.active").index()+1,h=P(b);m=!0;var k={left:b.position().top,right:e.position().top};e.addClass("active").siblings().removeClass("active");b.addClass("active").siblings().removeClass("active");A(f);a(".ms-auto-height").hasClass("active")&&!m&&(a(".ms-auto-height").animate({marginTop:0},c.scrollingSpeed,
c.easing),H(0));c.css3?(a.isFunction(c.onLeave)&&c.onLeave.call(this,g,d+1,h),b="translate3d(0px, -"+k.left+"px, 0px)",k="translate3d(0px, -"+k.right+"px, 0px)",r(a(".ms-left"),b,!0),r(a(".ms-right"),k,!0),setTimeout(function(){a.isFunction(c.afterLoad)&&c.afterLoad.call(this,f,d+1);setTimeout(function(){m=!1},600)},c.scrollingSpeed)):(a.isFunction(c.onLeave)&&c.onLeave.call(this,g,d+1,h),a(".ms-left").animate({top:-k.left},c.scrollingSpeed,c.easing,function(){a.isFunction(c.afterLoad)&&c.afterLoad.call(this,
f,d+1);setTimeout(function(){m=!1},600)}),a(".ms-right").animate({top:-k.right},c.scrollingSpeed,c.easing));lastScrolledDestiny=f;B(f);C(f,d)}}function I(){f.addEventListener?(f.addEventListener("mousewheel",p,!1),f.addEventListener("wheel",p,!1)):f.attachEvent("onmousewheel",p)}function p(b){b=h.event||b;b=v.max(-1,v.min(1,b.wheelDelta||-b.deltaY||-b.detail));m||(0>b?e.moveSectionDown():e.moveSectionUp());return!1}function r(b,a,c){b.toggleClass("ms-easing",c);b.css({"-webkit-transform":a,"-moz-transform":a,
"-ms-transform":a,transform:a})}function C(b,d){c.navigation&&(a("#multiscroll-nav").find(".active").removeClass("active"),b?a("#multiscroll-nav").find('a[href="#'+b+'"]').addClass("active"):a("#multiscroll-nav").find("li").eq(d).find("a").addClass("active"))}function B(b){c.menu&&(a(c.menu).find(".active").removeClass("active"),a(c.menu).find('[data-menuanchor="'+b+'"]').addClass("active"))}function P(b){var c=a(".ms-left .ms-section.active").index();b=b.index();return c>b?"up":"down"}function A(b){c.anchors.length&&
(location.hash=b);J()}function J(){var b=a(".ms-left .ms-section.active");console.log(b.length);if(b.length)var d=b.data("anchor"),e=b.index();else a(".ms-auto-height").length&&a(".ms-auto-height").hasClass("active")&&(d=a(".ms-auto-height").data("anchor"),e=a(".ms-left .ms-section").length);b=String(e);c.anchors.length&&(b=d);b=b.replace("/","-").replace("#","");d=RegExp("\\b\\s?ms-viewing-[^\\s]+\\b","g");a("body")[0].className=a("body")[0].className.replace(d,"");a("body").addClass("ms-viewing-"+
b)}function Q(){var b=f.createElement("p"),a,c={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};f.body.insertBefore(b,null);for(var e in c)b.style[e]!==E&&(b.style[e]="translate3d(1px,1px,1px)",a=h.getComputedStyle(b).getPropertyValue(c[e]));f.body.removeChild(b);return a!==E&&0<a.length&&"none"!==a}function K(b){b.addClass("ms-table").wrapInner('<div class="ms-tableCell" style="height: '+F(b)+'px" />')}
function F(b){var a=y;if(c.paddingTop||c.paddingBottom)b=parseInt(b.css("padding-top"))+parseInt(b.css("padding-bottom")),a=y-b;return a}function R(){var b=h.location.hash.replace("#",""),d=a('.ms-left .ms-section[data-anchor="'+b+'"]');b.length&&(d.length?g(d):(b=c.anchors[c.anchors.length-2],d=a(".ms-left").find('[data-anchor="'+b+'"]'),g(d),setTimeout(function(){q("down")},c.scrollingSpeed)))}function S(b){var d=b.originalEvent;D(d)&&(b.preventDefault(),a(".ms-left .ms-section.active"),m||(t=L(d).y,
v.abs(u-t)>a(h).height()/100*c.touchSensitivity&&(u>t?e.moveSectionDown():t>u&&e.moveSectionUp())))}function D(b){return"undefined"===typeof b.pointerType||"mouse"!=b.pointerType}function T(b){b=b.originalEvent;D(b)&&(u=L(b).y)}function L(b){var a=[];a.y="undefined"!==typeof b.pageY&&(b.pageY||b.pageX)?b.pageY:b.touches[0].pageY;a.x="undefined"!==typeof b.pageX&&(b.pageY||b.pageX)?b.pageX:b.touches[0].pageX;M&&D(b)&&(a.y=b.touches[0].pageY,a.x=b.touches[0].pageX);return a}var e=a.fn.multiscroll;c=
a.extend({verticalCentered:!0,scrollingSpeed:700,easing:"easeInQuart",menu:!1,sectionsColor:[],anchors:[],navigation:!1,navigationPosition:"right",navigationColor:"#000",navigationTooltips:[],loopBottom:!1,loopTop:!1,css3:!1,paddingTop:0,paddingBottom:0,fixedElements:null,normalScrollElements:null,keyboardScrolling:!0,touchSensitivity:5,sectionSelector:".ms-section",leftSelector:".ms-left",rightSelector:".ms-right",afterLoad:null,onLeave:null,afterRender:null,afterResize:null},c);var M="ontouchstart"in
h||0<navigator.msMaxTouchPoints||navigator.maxTouchPoints;".ms-right"!==c.rightSelector&&a(c.rightSelector).addClass("ms-right");".ms-left"!==c.leftSelector&&a(c.leftSelector).addClass("ms-left");var O=a(".ms-left").find(".ms-section").length,m=!1,n;a(this);var y=a(h).height();I();M&&(MSPointer=h.PointerEvent?{down:"pointerdown",move:"pointermove"}:{down:"MSPointerDown",move:"MSPointerMove"},a(f).off("touchstart "+MSPointer.down).on("touchstart "+MSPointer.down,T),a(f).off("touchmove "+MSPointer.move).on("touchmove "+
MSPointer.move,S));c.css3&&(c.css3=Q());a("html, body").css({overflow:"hidden",height:"100%"});".ms-section"!==c.sectionSelector&&a(c.sectionSelector).each(function(){a(this).addClass("ms-section")});c.navigation&&(a("body").append('<div id="multiscroll-nav"><ul></ul></div>'),n=a("#multiscroll-nav"),n.css("color",c.navigationColor),n.addClass(c.navigationPosition));a(".ms-right, .ms-left").css({width:"50%",position:"absolute",height:"100%","-ms-touch-action":"none"});a(".ms-right").css({right:"1px",
top:"0","-ms-touch-action":"none","touch-action":"none"});a(".ms-left").css({left:"0",top:"0","-ms-touch-action":"none","touch-action":"none"});3==a(".ms-left .ms-section").length&&1==a(".ms-auto-height").length&&9==a("a").length&&3==a("h1").length&&a(".ms-left .ms-section, .ms-right .ms-section").each(function(){var b=a(this).index();(c.paddingTop||c.paddingBottom)&&a(this).css("padding",c.paddingTop+" 0 "+c.paddingBottom+" 0");"undefined"!==typeof c.sectionsColor[b]&&a(this).css("background-color",
c.sectionsColor[b]);"undefined"!==typeof c.anchors[b]&&a(this).attr("data-anchor",c.anchors[b]);c.verticalCentered&&K(a(this));if(a(this).closest(".ms-left").length&&c.navigation){var d="";c.anchors.length&&(d=c.anchors[b]);b=c.navigationTooltips[b];"undefined"===typeof b&&(b="");c.navigation&&n.find("ul").append('<li data-tooltip="'+b+'"><a href="#'+d+'"><span></span></a></li>')}});a(".ms-auto-height").each(function(){var b=a(".ms-left .ms-section").length;a(this).attr("data-anchor",c.anchors[b]);
c.verticalCentered&&K(a(this));if(c.navigation){var d="";c.anchors.length&&(d=c.anchors[b]);b=c.navigationTooltips[b];"undefined"===typeof b&&(b="");c.navigation&&n.find("ul").append('<li data-tooltip="'+b+'"><a href="#'+d+'"><span></span></a></li>')}});a(".ms-right").html(a(".ms-right").find(".ms-section").get().reverse());a(".ms-left .ms-section, .ms-right .ms-section").each(function(){var b=a(this).index();a(this).css({height:"100%"});!b&&c.navigation&&n.find("li").eq(b).find("a").addClass("active")}).promise().done(function(){a(".ms-left .ms-section.active").length||
(a(".ms-right").find(".ms-section").last().addClass("active"),a(".ms-left").find(".ms-section").first().addClass("active"));c.navigation&&n.css("margin-top","-"+n.height()/2+"px");a.isFunction(c.afterRender)&&c.afterRender.call(this);G();J();a(h).on("load",function(){R()})});a(h).on("hashchange",w);a(f).keydown(function(b){clearTimeout(N);var d=a(f.activeElement);d.is("textarea")||d.is("input")||d.is("select")||!c.keyboardScrolling||(-1<a.inArray(b.which,[40,38,32,33,34])&&b.preventDefault(),N=setTimeout(function(){var c=
b.shiftKey;switch(b.which){case 38:case 33:e.moveSectionUp();break;case 32:if(c){e.moveSectionUp();break}case 40:case 34:e.moveSectionDown();break;case 36:e.moveTo(1);break;case 35:e.moveTo(a(".ms-left .ms-section").length)}},150))});var N;a(f).mousedown(function(a){if(1==a.button)return a.preventDefault(),!1});a(f).on("click","#multiscroll-nav a",function(b){b.preventDefault();b=a(this).parent().index();var d=a(".ms-left .ms-section").eq(b);d.length?a(".ms-auto-height").hasClass("active")?q("up",
function(){console.warn("callback!");g(d)}):g(d):(g(a(".ms-left .ms-section").eq(b-1)),setTimeout(function(){e.moveSectionDown()},c.scrollingSpeed))});a(f).on({mouseenter:function(){var b=a(this).data("tooltip");a('<div class="multiscroll-tooltip '+c.navigationPosition+'">'+b+"</div>").hide().appendTo(a(this)).fadeIn(200)},mouseleave:function(){a(this).find(".multiscroll-tooltip").fadeOut(200,function(){a(this).remove()})}},"#multiscroll-nav li");c.normalScrollElements&&(a(f).on("mouseenter",c.normalScrollElements,
function(){e.setMouseWheelScrolling(!1)}),a(f).on("mouseleave",c.normalScrollElements,function(){e.setMouseWheelScrolling(!0)}));a(h).on("resize",x);e.moveSectionUp=function(){if(a(".ms-auto-height").hasClass("active"))q("up");else{var b=a(".ms-left .ms-section.active").prev(".ms-section");!b.length&&c.loopTop&&(b=a(".ms-left .ms-section").last());b.length?g(b):a(".ms-auto-height").length&&a(".ms-auto-height").hasClass("active")&&z("up")}};e.moveSectionDown=function(){var b=a(".ms-left .ms-section.active").next(".ms-section");
!b.length&&c.loopBottom&&(b=a(".ms-left .ms-section").first());b.length?g(b):a(".ms-auto-height").length&&z("down")};e.moveTo=function(b){if(a(".ms-auto-height").hasClass("active"))z("down");else{var c="",c=isNaN(b)?a('.ms-left [data-anchor="'+b+'"]'):a(".ms-left .ms-section").eq(b-1);g(c)}};e.setKeyboardScrolling=function(a){c.keyboardScrolling=a};e.setMouseWheelScrolling=function(a){a?I():f.addEventListener?(f.removeEventListener("mousewheel",p,!1),f.removeEventListener("wheel",p,!1)):f.detachEvent("onmousewheel",
p)};e.setScrollingSpeed=function(a){c.scrollingSpeed=a};var u=0,t=0;e.destroy=function(){e.setKeyboardScrolling(!1);e.setMouseWheelScrolling(!1);a(h).off("hashchange",w).off("resize",x);a(f).off("mouseenter","#multiscroll-nav li").off("mouseleave","#multiscroll-nav li").off("click","#multiscroll-nav a")};e.build=function(){e.setKeyboardScrolling(!0);e.setMouseWheelScrolling(!0);a(h).on("hashchange",w).on("resize",x);a(f).on("mouseenter","#multiscroll-nav li").on("mouseleave","#multiscroll-nav li").on("click",
"#multiscroll-nav a")}}})(jQuery,window,document,Math);