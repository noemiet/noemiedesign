/**
 * multiscroll.js 0.1.7 Beta (Customized with auto-height section)
 * https://github.com/alvarotrigo/multiscroll.js
 *
 * Copyright (C) 2013 alvarotrigo.com - A project by Alvaro Trigo
 */
(function(a,h,f,x,F){a.fn.multiscroll=function(c){function y(){var b=h.location.hash.replace("#","");if(b.length){var e=a(".ms-left").find('[data-anchor="'+b+'"]');if(e.length){var l="undefined"===typeof lastScrolledDestiny;if(l||b!==lastScrolledDestiny)a(".ms-auto-height").hasClass("active")?q("up",function(){g(e)}):g(e)}else b==c.anchors[c.anchors.length-1]&&(b=c.anchors[c.anchors.length-2],e=a(".ms-left").find('[data-anchor="'+b+'"]'),(l="undefined"===typeof lastScrolledDestiny)||c.anchors[c.anchors.length-
1]!==lastScrolledDestiny)&&(g(e),setTimeout(function(){d.moveSectionDown()},c.scrollingSpeed))}}function G(b){b.preventDefault();b=a(this).parent().index();g(a(".ms-left .ms-section").eq(b))}function H(){var b=a(this).data("tooltip");a('<div class="multiscroll-tooltip '+c.navigationPosition+'">'+b+"</div>").hide().appendTo(a(this)).fadeIn(200)}function I(){a(this).find(".multiscroll-tooltip").fadeOut(200,function(){a(this).remove()})}function z(){A=a(h).height();a(".ms-tableCell").each(function(){a(this).css({height:J(a(this).parent())})});
K();a.isFunction(c.afterResize)&&c.afterResize.call(this)}function K(){if(c.css3)if(a(".ms-left").find(".ms-section.active").length)m(a(".ms-left"),"translate3d(0px, -"+a(".ms-left").find(".ms-section.active").position().top+"px, 0px)",!1),m(a(".ms-right"),"translate3d(0px, -"+a(".ms-right").find(".ms-section.active").position().top+"px, 0px)",!1);else{m(a(".ms-left"),"translate3d(0px, -"+a(".ms-left").find(".ms-section").last().position().top+"px, 0px)",!1);m(a(".ms-right"),"translate3d(0px, -"+
a(".ms-right").find(".ms-section").first().position().top+"px, 0px)",!1);var b=a(".ms-auto-height.active").height(),e="translate3d(0px, "+(t(a(".ms-left"))-b)+"px, 0px)",b="translate3d(0px, "+(t(a(".ms-right"))-b)+"px, 0px)";m(a(".ms-left"),e,!1);m(a(".ms-right"),b,!1)}else a(".ms-left").css("top",-a(".ms-left").find(".ms-section.active").position().top),a(".ms-right").css("top",-a(".ms-right").find(".ms-section.active").position().top)}function q(b,e){var l=a(".ms-auto-height"),f=a(".ms-left .ms-section").length,
d=f-1;l.position();a(h).height();l.height();a.isFunction(c.onLeave)&&c.onLeave.call(this,d,f+1,b);if("down"==b){var g=l.height(),d=-g,p=a(".ms-auto-height").data("anchor");l.addClass("active");a(".ms-left").find(".ms-section").removeClass("active");a(".ms-right").find(".ms-section").removeClass("active");u(p);lastScrolledDestiny=p;B(p);C(p,f)}else{var d="none",g="0",d=l.height(),k=a(".ms-left").find(".ms-section").last(),p=k.data("anchor");l.removeClass("active");a(".ms-left").find(".ms-section").last().addClass("active");
a(".ms-right").find(".ms-section").first().addClass("active");u(p);lastScrolledDestiny=p;u(k.data("anchor"));B(k.data("anchor"));C(k.data("anchor"),k.index())}n=!0;c.css3&&l.addClass("ms-easing");c.css3?(g="translate3d(0px, "+(t(a(".ms-left"))+d)+"px, 0px)",k="translate3d(0px, "+(t(a(".ms-right"))+d)+"px, 0px)",d="translate3d(0px, "+(t(l)+d)+"px, 0px)",m(a(".ms-left"),g,!0),m(a(".ms-right"),k,!0),m(l,d,!0),setTimeout(function(){n=!1},600)):(l.animate({marginTop:-g},c.scrollingSpeed,c.easing,function(){"down"==
b&&a.isFunction(c.afterLoad)&&c.afterLoad.call(this,p,f+1);a.isFunction(e)&&e.call(this)}),L(g,b))}function t(b){var a=b.css("transform"),a="undefined"===typeof a?b.css("-webkit-transform"):a;return"undefined"!==typeof a&&"none"!==a?parseInt(a.split(",")[5]):0}function L(b,e){if(c.css3)a(".ms-right").animate({top:-b},c.scrollingSpeed,c.easing),a(".ms-left").animate({top:-b},c.scrollingSpeed,c.easing,function(){setTimeout(function(){n=!1},600)});else{var d=a(".ms-left").find(".ms-section").last().position().top;
a(".ms-right").animate({top:-b},c.scrollingSpeed,c.easing);d=-d-b;"up"==e&&(d=parseInt(a(".ms-left").css("top"))+a(".ms-auto-height").height());a(".ms-left").animate({top:d},c.scrollingSpeed,c.easing,function(){setTimeout(function(){n=!1},600)})}}function g(b){var e=b.index(),d=a(".ms-right").find(".ms-section").eq(T-1-e),f=b.data("anchor"),g=a(".ms-left .ms-section.active").index()+1,k=U(b);n=!0;var h={left:b.position().top,right:d.position().top};d.addClass("active").siblings().removeClass("active");
b.addClass("active").siblings().removeClass("active");u(f);a(".ms-auto-height").hasClass("active")&&!n&&(a(".ms-auto-height").animate({marginTop:0},c.scrollingSpeed,c.easing),L(0));c.css3?(a.isFunction(c.onLeave)&&c.onLeave.call(this,g,e+1,k),b="translate3d(0px, -"+h.left+"px, 0px)",h="translate3d(0px, -"+h.right+"px, 0px)",m(a(".ms-left"),b,!0),m(a(".ms-right"),h,!0),setTimeout(function(){a.isFunction(c.afterLoad)&&c.afterLoad.call(this,f,e+1);setTimeout(function(){n=!1},600)},c.scrollingSpeed)):
(a.isFunction(c.onLeave)&&c.onLeave.call(this,g,e+1,k),a(".ms-left").animate({top:-h.left},c.scrollingSpeed,c.easing,function(){a.isFunction(c.afterLoad)&&c.afterLoad.call(this,f,e+1);setTimeout(function(){n=!1},600)}),a(".ms-right").animate({top:-h.right},c.scrollingSpeed,c.easing));lastScrolledDestiny=f;B(f);C(f,e)}function M(){f.addEventListener?(f.addEventListener("mousewheel",r,!1),f.addEventListener("wheel",r,!1)):f.attachEvent("onmousewheel",r)}function r(b){b=h.event||b;b=x.max(-1,x.min(1,
b.wheelDelta||-b.deltaY||-b.detail));n||(0>b?d.moveSectionDown():d.moveSectionUp());return!1}function m(b,a,c){b.toggleClass("ms-easing",c);b.css({"-webkit-transform":a,"-moz-transform":a,"-ms-transform":a,transform:a})}function C(b,e){c.navigation&&(a("#multiscroll-nav").find(".active").removeClass("active"),b?a("#multiscroll-nav").find('a[href="#'+b+'"]').addClass("active"):a("#multiscroll-nav").find("li").eq(e).find("a").addClass("active"))}function B(b){c.menu&&(a(c.menu).find(".active").removeClass("active"),
a(c.menu).find('[data-menuanchor="'+b+'"]').addClass("active"))}function U(b){var c=a(".ms-left .ms-section.active").index();b=b.index();return c>b?"up":"down"}function u(a){c.anchors.length&&(location.hash=a);N()}function N(){var b=a(".ms-left .ms-section.active");if(b.length)var e=b.data("anchor"),d=b.index();else a(".ms-auto-height").length&&a(".ms-auto-height").hasClass("active")&&(e=a(".ms-auto-height").data("anchor"),d=a(".ms-left .ms-section").length);b=String(d);c.anchors.length&&(b=e);b=
b.replace("/","-").replace("#","");e=RegExp("\\b\\s?ms-viewing-[^\\s]+\\b","g");a("body")[0].className=a("body")[0].className.replace(e,"");a("body").addClass("ms-viewing-"+b)}function V(){var a=f.createElement("p"),c,d={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};f.body.insertBefore(a,null);for(var g in d)a.style[g]!==F&&(a.style[g]="translate3d(1px,1px,1px)",c=h.getComputedStyle(a).getPropertyValue(d[g]));
f.body.removeChild(a);return c!==F&&0<c.length&&"none"!==c}function O(a){a.addClass("ms-table").wrapInner('<div class="ms-tableCell" style="height: '+J(a)+'px" />')}function J(a){var b=A;if(c.paddingTop||c.paddingBottom)a=parseInt(a.css("padding-top"))+parseInt(a.css("padding-bottom")),b=A-a;return b}function W(){var b=h.location.hash.replace("#",""),e=a('.ms-left .ms-section[data-anchor="'+b+'"]');b.length&&(e.length?g(e):(b=c.anchors[c.anchors.length-2],e=a(".ms-left").find('[data-anchor="'+b+'"]'),
g(e),setTimeout(function(){q("down")},c.scrollingSpeed)))}function X(b){var e=b.originalEvent;D(e)&&(b.preventDefault(),a(".ms-left .ms-section.active"),n||(v=P(e).y,x.abs(w-v)>a(h).height()/100*c.touchSensitivity&&(w>v?d.moveSectionDown():v>w&&d.moveSectionUp())))}function D(a){return"undefined"===typeof a.pointerType||"mouse"!=a.pointerType}function Y(a){a=a.originalEvent;D(a)&&(w=P(a).y)}function Q(){E&&(MSPointer=R(),a(f).off("touchstart "+MSPointer.down).on("touchstart "+MSPointer.down,Y),a(f).off("touchmove "+
MSPointer.move).on("touchmove "+MSPointer.move,X))}function R(){return h.PointerEvent?{down:"pointerdown",move:"pointermove"}:{down:"MSPointerDown",move:"MSPointerMove"}}function P(a){var b=[];b.y="undefined"!==typeof a.pageY&&(a.pageY||a.pageX)?a.pageY:a.touches[0].pageY;b.x="undefined"!==typeof a.pageX&&(a.pageY||a.pageX)?a.pageX:a.touches[0].pageX;E&&D(a)&&(b.y=a.touches[0].pageY,b.x=a.touches[0].pageX);return b}var d=a.fn.multiscroll;c=a.extend({verticalCentered:!0,scrollingSpeed:700,easing:"easeInQuart",
menu:!1,sectionsColor:[],anchors:[],navigation:!1,navigationPosition:"right",navigationColor:"#000",navigationTooltips:[],loopBottom:!1,loopTop:!1,css3:!0,paddingTop:0,paddingBottom:0,fixedElements:null,normalScrollElements:null,keyboardScrolling:!0,touchSensitivity:5,sectionSelector:".ms-section",leftSelector:".ms-left",rightSelector:".ms-right",afterLoad:null,onLeave:null,afterRender:null,afterResize:null},c);var E="ontouchstart"in h||0<navigator.msMaxTouchPoints||navigator.maxTouchPoints;".ms-right"!==
c.rightSelector&&a(c.rightSelector).addClass("ms-right");".ms-left"!==c.leftSelector&&a(c.leftSelector).addClass("ms-left");var T=a(".ms-left").find(".ms-section").length,n=!1,k;a(this);var A=a(h).height();M();Q();c.css3&&(c.css3=V());a("html, body").css({overflow:"hidden",height:"100%"});".ms-section"!==c.sectionSelector&&a(c.sectionSelector).each(function(){a(this).addClass("ms-section")});c.navigation&&(a("body").append('<div id="multiscroll-nav"><ul></ul></div>'),k=a("#multiscroll-nav"),k.css("color",
c.navigationColor),k.addClass(c.navigationPosition));a(".ms-right, .ms-left").css({width:"50%",position:"absolute",height:"100%","-ms-touch-action":"none"});a(".ms-right").css({right:"1px",top:"0","-ms-touch-action":"none","touch-action":"none"});a(".ms-left").css({left:"0",top:"0","-ms-touch-action":"none","touch-action":"none"});a(".ms-left .ms-section, .ms-right .ms-section").each(function(){var b=a(this).index();(c.paddingTop||c.paddingBottom)&&a(this).css("padding",c.paddingTop+" 0 "+c.paddingBottom+
" 0");"undefined"!==typeof c.sectionsColor[b]&&a(this).css("background-color",c.sectionsColor[b]);"undefined"!==typeof c.anchors[b]&&a(this).attr("data-anchor",c.anchors[b]);c.verticalCentered&&O(a(this));if(a(this).closest(".ms-left").length&&c.navigation){var d="";c.anchors.length&&(d=c.anchors[b]);b=c.navigationTooltips[b];"undefined"===typeof b&&(b="");c.navigation&&k.find("ul").append('<li data-tooltip="'+b+'"><a href="#'+d+'"><span></span></a></li>')}});a(".ms-auto-height").each(function(){var b=
a(".ms-left .ms-section").length;a(this).attr("data-anchor",c.anchors[b]);c.verticalCentered&&O(a(this));if(c.navigation){var d="";c.anchors.length&&(d=c.anchors[b]);b=c.navigationTooltips[b];"undefined"===typeof b&&(b="");c.navigation&&k.find("ul").append('<li data-tooltip="'+b+'"><a href="#'+d+'"><span></span></a></li>')}});a(".ms-right").html(a(".ms-right").find(".ms-section").get().reverse());a(".ms-left .ms-section, .ms-right .ms-section").each(function(){var b=a(this).index();a(this).css({height:"100%"});
!b&&c.navigation&&k.find("li").eq(b).find("a").addClass("active")}).promise().done(function(){a(".ms-left .ms-section.active").length||(a(".ms-right").find(".ms-section").last().addClass("active"),a(".ms-left").find(".ms-section").first().addClass("active"));c.navigation&&k.css("margin-top","-"+k.height()/2+"px");a.isFunction(c.afterRender)&&c.afterRender.call(this);K();N();a(h).on("load",function(){W()})});a(h).on("hashchange",y);a(f).keydown(function(b){clearTimeout(S);var e=a(f.activeElement);
e.is("textarea")||e.is("input")||e.is("select")||!c.keyboardScrolling||(-1<a.inArray(b.which,[40,38,32,33,34])&&b.preventDefault(),S=setTimeout(function(){var c=b.shiftKey;switch(b.which){case 38:case 33:d.moveSectionUp();break;case 32:if(c){d.moveSectionUp();break}case 40:case 34:d.moveSectionDown();break;case 36:d.moveTo(1);break;case 35:d.moveTo(a(".ms-left .ms-section").length)}},150))});var S;a(f).mousedown(function(a){if(1==a.button)return a.preventDefault(),!1});a(f).on("click","#multiscroll-nav a",
function(b){b.preventDefault();b=a(this).parent().index();var e=a(".ms-left .ms-section").eq(b);e.length?a(".ms-auto-height").hasClass("active")?q("up",function(){g(e)}):g(e):(g(a(".ms-left .ms-section").eq(b-1)),setTimeout(function(){d.moveSectionDown()},c.scrollingSpeed))});a(f).on("click","#multiscroll-nav a",G);a(f).on({mouseenter:H,mouseleave:I},"#multiscroll-nav li");c.normalScrollElements&&(a(f).on("mouseenter",c.normalScrollElements,function(){d.setMouseWheelScrolling(!1)}),a(f).on("mouseleave",
c.normalScrollElements,function(){d.setMouseWheelScrolling(!0)}));a(h).on("resize",z);d.moveSectionUp=function(){if(a(".ms-auto-height").hasClass("active"))q("up");else{var b=a(".ms-left .ms-section.active").prev(".ms-section");!b.length&&c.loopTop&&(b=a(".ms-left .ms-section").last());b.length?g(b):a(".ms-auto-height").length&&a(".ms-auto-height").hasClass("active")&&q("up")}};d.moveSectionDown=function(){var b=a(".ms-left .ms-section.active").next(".ms-section");!b.length&&c.loopBottom&&(b=a(".ms-left .ms-section").first());
b.length?g(b):a(".ms-auto-height").length&&!a(".ms-auto-height").hasClass("active")&&q("down")};d.moveTo=function(b){a(".ms-auto-height").hasClass("active")?q("down"):(b=isNaN(b)?a('.ms-left [data-anchor="'+b+'"]'):a(".ms-left .ms-section").eq(b-1),g(b))};d.setKeyboardScrolling=function(a){c.keyboardScrolling=a};d.setMouseWheelScrolling=function(a){a?M():f.addEventListener?(f.removeEventListener("mousewheel",r,!1),f.removeEventListener("wheel",r,!1)):f.detachEvent("onmousewheel",r)};d.setScrollingSpeed=
function(a){c.scrollingSpeed=a};var w=0,v=0;d.destroy=function(){d.setKeyboardScrolling(!1);d.setMouseWheelScrolling(!1);E&&(MSPointer=R(),a(f).off("touchstart "+MSPointer.down),a(f).off("touchmove "+MSPointer.move));a(h).off("hashchange",y).off("resize",z);a(f).off("mouseenter","#multiscroll-nav li").off("mouseleave","#multiscroll-nav li").off("click","#multiscroll-nav a")};d.build=function(){d.setKeyboardScrolling(!0);d.setMouseWheelScrolling(!0);Q();a(h).on("hashchange",y).on("resize",z);a(f).on("mouseenter",
"#multiscroll-nav li",H).on("mouseleave","#multiscroll-nav li",I).on("click","#multiscroll-nav a",G)}}})(jQuery,window,document,Math);